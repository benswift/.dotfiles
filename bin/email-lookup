#!/bin/bash

set -euo pipefail

selection=$(mu cfind --format=mutt-ab '' 2>/dev/null \
    | fzf --height=40% --reverse --no-sort --ansi)

if [ -n "$selection" ]; then
    formatted=$(echo "$selection" | awk -F'\t' '{print $2 " <" $1 ">"}')
    printf "%s" "$formatted" | pbcopy
    echo "Copied to clipboard: $formatted"
fi
